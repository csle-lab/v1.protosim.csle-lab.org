(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9758:function(e,t,n){"use strict";e.exports=n(9512)},9512:function(e,t,n){"use strict";var r=n(3454),i=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if(void 0===r||void 0===r.domain)throw Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||i.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||i.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||i.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=i.DEFAULT_MAX_PENDING};i.DEFAULT_TIMEOUT=0,i.DEFAULT_MAX_OCCUPATION_TIME=0,i.DEFAULT_MAX_EXECUTION_TIME=0,i.DEFAULT_MAX_PENDING=1e3,i.prototype.acquire=function(e,t,n,i){if(Array.isArray(e))return this._acquireBatch(e,t,n,i);if("function"!=typeof t)throw Error("You must pass a function to execute");var o=null,c=null,a=null;"function"!=typeof n&&(i=n,n=null,a=new this.Promise(function(e,t){o=e,c=t})),i=i||{};var u=!1,s=null,l=null,f=null,h=this,d=function(t,r,i){l&&(clearTimeout(l),l=null),f&&(clearTimeout(f),f=null),t&&(h.queues[e]&&0===h.queues[e].length&&delete h.queues[e],h.domainReentrant&&delete h.domains[e]),u||(a?r?c(r):o(i):"function"==typeof n&&n(r,i),u=!0),t&&h.queues[e]&&h.queues[e].length>0&&h.queues[e].shift()()},p=function(n){if(u)return d(n);s&&(clearTimeout(s),s=null),h.domainReentrant&&n&&(h.domains[e]=r.domain);var o=i.maxExecutionTime||h.maxExecutionTime;if(o&&(f=setTimeout(function(){h.queues[e]&&d(n,Error("Maximum execution time is exceeded "+e))},o)),1===t.length){var c=!1;try{t(function(e,t){c||(c=!0,d(n,e,t))})}catch(a){c||(c=!0,d(n,a))}}else h._promiseTry(function(){return t()}).then(function(e){d(n,void 0,e)},function(e){d(n,e)})};if(h.domainReentrant&&r.domain&&(p=r.domain.bind(p)),h.queues[e]){if(h.domainReentrant&&r.domain&&r.domain===h.domains[e])p(!1);else if(h.queues[e].length>=h.maxPending)d(!1,Error("Too many pending tasks in queue "+e));else{var m=function(){p(!0)};i.skipQueue?h.queues[e].unshift(m):h.queues[e].push(m);var v=i.timeout||h.timeout;v&&(s=setTimeout(function(){s=null,d(!1,Error("async-lock timed out in queue "+e))},v))}}else h.queues[e]=[],p(!0);var g=i.maxOccupationTime||h.maxOccupationTime;if(g&&(l=setTimeout(function(){h.queues[e]&&d(!1,Error("Maximum occupation time is exceeded in queue "+e))},g)),a)return a},i.prototype._acquireBatch=function(e,t,n,r){"function"!=typeof n&&(r=n,n=null);var i=this,o=e.reduceRight(function(e,t){var n,o;return function(n){i.acquire(t,e,n,r)}},t);if("function"!=typeof n)return new this.Promise(function(e,t){1===o.length?o(function(n,r){n?t(n):e(r)}):e(o())});o(n)},i.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0},i.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(t){return this.Promise.reject(t)}},e.exports=i},3454:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(7663)},8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7293)}])},593:function(e,t,n){"use strict";n.d(t,{Ad:function(){return l},Ms:function(){return p},Wq:function(){return b},bZ:function(){return _},jl:function(){return v}});var r=n(7568),i=n(655),o=n(1864),c=n.n(o),a=n(9758),u=new(n.n(a)());function s(){return window.location.pathname}function l(){return"https://protosim.csle-lab.org/protosim-back"}var f=void 0,h=new Date("2000/1/1");function d(){return(d=(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[2];case 1:return f=e.sent(),h=new Date,[2]}})})).apply(this,arguments)}function p(){return m.apply(this,arguments)}function m(){return(m=(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[4,u.acquire("getUsername",(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:if(!(new Date().getTime()-h.getTime()>6e4))return[3,2];return[4,function(){return d.apply(this,arguments)}()];case 1:e.sent(),e.label=2;case 2:return[2]}})}))];case 1:return e.sent(),[2,f]}})})).apply(this,arguments)}function v(){return g.apply(this,arguments)}function g(){return(g=(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[4,p()];case 1:return[2,null!=e.sent()]}})})).apply(this,arguments)}function _(e){return x.apply(this,arguments)}function x(){return(x=(0,r.Z)(function(e){var t;return(0,i.__generator)(this,function(n){switch(n.label){case 0:switch(t={eventName:"tool_"+e.type,href:window.location.href,pathname:s()},e.type){case"moveCover":t.message=e.coverPosition?"フタを開けた":"フタを閉じた",t.event_coverPosition=e.coverPosition;break;case"enterAddressBar":t.message="アドレスバーで ".concat(e.url," にアクセスした"),t.event_url=e.url;break;case"movePipe":t.message="海を".concat("up"===e.direction?"上":"下","方向に動かして ").concat(T(e.destination)," にセットした"),t.event_direction=e.direction,t.event_destination=e.destination;break;case"openInsertPage":t.event_device=e.device,t.event_protocolIndex=e.protocolIndex;break;case"insertManually":t.message="".concat("smartphone"===e.device?"スマートフォン":"Web サーバ","の ").concat(T(e.protocolIndex)," に情報を直接流し込んだ: ").concat(e.body),t.event_device=e.device,t.event_protocolIndex=e.protocolIndex,t.event_body=e.body;break;case"openDataPage":t.message="".concat("smartphone"===e.device?"スマートフォン":"Web サーバ","の").concat("downToUp"===e.direction?"上":"下","向きの ").concat(T(e.protocolIndex)," に流れた情報を観察した"),t.event_device=e.device,t.event_direction=e.direction,t.event_protocolIndex=e.protocolIndex;break;case"executeTask":default:return[2];case"hoverTerminology":t.event_key=e.key,t.event_direction=e.direction;break;case"enterTextbox":t.message="テキストボックス (".concat(e.textboxKey,") に「").concat(e.value,"」と入力した"),t.event_textboxKey=e.textboxKey,t.event_value=e.value;break;case"showHint":t.message="".concat(e.numVisibleHints," 番目のヒントを表示した"),t.event_numVisibleHints=e.numVisibleHints;break;case"finishGoal":case"completePage":t.event_key=e.key}return[4,fetch(c().join(l(),"/student/add_log.cgi"),{method:"POST",body:JSON.stringify(t)}).then(function(e){})];case 1:return n.sent(),[2]}})})).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=(0,r.Z)(function(e){var t;return(0,i.__generator)(this,function(n){switch(n.label){case 0:switch(t={eventName:e.type,href:window.location.href,pathname:s()},e.type){case"view":case"keep":case"login":case"logout":break;default:return[2]}return[4,fetch(c().join(l(),"student/add_log.cgi"),{method:"POST",body:JSON.stringify(t)}).then(function(e){})];case 1:return n.sent(),[2]}})})).apply(this,arguments)}function T(e){switch(e){case 0:return"HTTP";case 1:return"TCP";case 2:return"IP";case 3:return"イーサネット"}return"???"}},7293:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(7568),i=n(655),o=n(5893),c=n(9008),a=n.n(c),u=n(7294),s=n(593),l=n(9807),f=n.n(l);/*! js-cookie v3.0.5 | MIT */ function h(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var d=function e(t,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=h({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var c in i){if(i[c])o+="; "+c,!0!==i[c]&&(o+="="+i[c].split(";")[0])}return document.cookie=e+"="+t.write(r,e)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),c=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=t.read(c,a),e===a)break}catch(u){}}return e?r[e]:r}},remove:function(e,t){r(e,"",h({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,h({},this.attributes,t))},withConverter:function(t){return e(h({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function p(){return(p=(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[2,{accessToken:"",enableKey:""}];case 1:return[2,e.sent()]}})})).apply(this,arguments)}function m(){return(m=(0,r.Z)(function(e){var t;return(0,i.__generator)(this,function(n){return(t=new URLSearchParams).set("app","ProtoSim"),t.set("enableKey",e),t.set("redirect",window.location.href),window.location.assign("".concat("https://".concat(location.host.replace("protosim","auth")),"/student/enableAccessToken/?").concat(t)),[2]})})).apply(this,arguments)}n(1864);var v=function(){var e=(0,u.useState)(void 0),t=e[0],n=e[1];function c(){return(c=(0,r.Z)(function(){var e,t;return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,(0,s.Wq)({type:"login"})];case 1:return t.sent(),[4,function(){return p.apply(this,arguments)}()];case 2:return(e=t.sent()).accessToken,[4,function(e){return m.apply(this,arguments)}(e.enableKey)];case 3:return t.sent(),[2]}})})).apply(this,arguments)}function l(){return(l=(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,s.Wq)({type:"logout"})];case 1:return e.sent(),d.remove("PROTOSIM_ACCESS_TOKEN",{path:"/"}),n(null),[2]}})})).apply(this,arguments)}return(0,u.useEffect)(function(){(0,r.Z)(function(){return(0,i.__generator)(this,function(e){return(0,s.Wq)({type:"view"}),[2]})})()},[]),(0,u.useEffect)(function(){setInterval((0,r.Z)(function(){return(0,i.__generator)(this,function(e){return(0,s.Wq)({type:"keep"}),[2]})}),1e4)},[]),(0,u.useEffect)(function(){(0,r.Z)(function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,s.Ms)()];case 1:return n.apply(void 0,[e.sent()]),[2]}})})()},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a(),{children:(0,o.jsx)("title",{children:"ProtoSim - 通信プロトコルシミュレータ"})}),(0,o.jsx)("div",{className:f().home,children:(0,o.jsxs)("main",{className:f().homeInner,children:[(0,o.jsxs)("h1",{children:["通信プロトコルシミュレータ",(0,o.jsx)("br",{}),"ProtoSim",(0,o.jsx)("div",{children:"プロトシム"})]}),(0,o.jsx)("div",{className:f().formArea,children:null===t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:f().formPanel,children:(0,o.jsx)("div",{className:f().row,children:(0,o.jsx)("button",{className:f().button,type:"button",onClick:function(e){return function(){return c.apply(this,arguments)}()},children:"学習環境ID でログイン"})})}),(0,o.jsx)("div",{className:f().formPanel,children:(0,o.jsx)("div",{className:f().row,children:(0,o.jsx)("a",{className:f().button,href:"./app",children:"ゲストユーザとして利用"})})})]}):null!=t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:f().formPanel,children:(0,o.jsx)("div",{className:f().row,children:(0,o.jsx)("a",{className:f().button,href:"./app",children:"ユーザ "+t+" として利用"})})}),(0,o.jsx)("div",{className:f().formPanel,children:(0,o.jsx)("div",{className:f().row,children:(0,o.jsx)("button",{className:f().button,type:"button",onClick:function(e){return function(){return l.apply(this,arguments)}()},children:"ログアウト"})})})]}):(0,o.jsx)("div",{className:f().formPanel,children:(0,o.jsx)("div",{className:f().row,children:(0,o.jsx)("a",{className:f().button,href:"./app",children:"ゲストユーザとして利用"})})})})]})})]})}},9807:function(e){e.exports={home:"Top_home__P1Voi",homeInner:"Top_homeInner__bpRTM",formArea:"Top_formArea__1JQeK",formPanel:"Top_formPanel__AML1o",row:"Top_row__OXT_q",col:"Top_col__6tq2j",button:"Top_button__y1Hvt",loginMessage:"Top_loginMessage__W0Kqn",fadeUp:"Top_fadeUp__ILC6Q",fadeUpAnim:"Top_fadeUpAnim__VaN40"}},1864:function(e){!function(){"use strict";var t={114:function(e){function t(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",i=0,o=-1,c=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else if(47===n)break;else n=47;if(47===n){if(o===a-1||1===c);else if(o!==a-1&&2===c){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2)){if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",i=0):i=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),o=a,c=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=a,c=0;continue}}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,a):r=e.slice(o+1,a),i=a-o-1;o=a,c=0}else 46===n&&-1!==c?++c:c=-1}return r}var r={resolve:function(){for(var e,r,i="",o=!1,c=arguments.length-1;c>=-1&&!o;c--)c>=0?r=arguments[c]:(void 0===e&&(e=""),r=e),t(r),0!==r.length&&(i=r+"/"+i,o=47===r.charCodeAt(0));return(i=n(i,!o),o)?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return(0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r)?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var i=arguments[n];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n||(e=r.resolve(e))===(n=r.resolve(n)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var o=e.length,c=o-i,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var u=n.length-a,s=c<u?c:u,l=-1,f=0;f<=s;++f){if(f===s){if(u>s){if(47===n.charCodeAt(a+f))return n.slice(a+f+1);if(0===f)return n.slice(a+f)}else c>s&&(47===e.charCodeAt(i+f)?l=f:0===f&&(l=0));break}var h=e.charCodeAt(i+f);if(h!==n.charCodeAt(a+f))break;47===h&&(l=f)}var d="";for(f=i+l+1;f<=o;++f)(f===o||47===e.charCodeAt(f))&&(0===d.length?d+="..":d+="/..");return d.length>0?d+n.slice(a+l):(a+=l,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,i=-1,o=!0,c=e.length-1;c>=1;--c)if(47===(n=e.charCodeAt(c))){if(!o){i=c;break}}else o=!1;return -1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw TypeError('"ext" argument must be a string');t(e);var r,i=0,o=-1,c=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,u=-1;for(r=e.length-1;r>=0;--r){var s=e.charCodeAt(r);if(47===s){if(!c){i=r+1;break}}else -1===u&&(c=!1,u=r+1),a>=0&&(s===n.charCodeAt(a)?-1==--a&&(o=r):(a=-1,o=u))}return i===o?o=u:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!c){i=r+1;break}}else -1===o&&(c=!1,o=r+1);return -1===o?"":e.slice(i,o)},extname:function(e){t(e);for(var n=-1,r=0,i=-1,o=!0,c=0,a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(47===u){if(!o){r=a+1;break}continue}-1===i&&(o=!1,i=a+1),46===u?-1===n?n=a:1!==c&&(c=1):-1!==n&&(c=-1)}return -1===n||-1===i||0===c||1===c&&n===i-1&&n===r+1?"":e.slice(n,i)},format:function(e){var t,n,r;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return n=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||""),n?n===e.root?n+r:n+"/"+r:r},parse:function(e){t(e);var n,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var i=e.charCodeAt(0),o=47===i;o?(r.root="/",n=1):n=0;for(var c=-1,a=0,u=-1,s=!0,l=e.length-1,f=0;l>=n;--l){if(47===(i=e.charCodeAt(l))){if(!s){a=l+1;break}continue}-1===u&&(s=!1,u=l+1),46===i?-1===c?c=l:1!==f&&(f=1):-1!==c&&(f=-1)}return -1===c||-1===u||0===f||1===f&&c===u-1&&c===a+1?-1!==u&&(0===a&&o?r.base=r.name=e.slice(1,u):r.base=r.name=e.slice(a,u)):(0===a&&o?(r.name=e.slice(1,c),r.base=e.slice(1,u)):(r.name=e.slice(a,c),r.base=e.slice(a,u)),r.ext=e.slice(c,u)),a>0?r.dir=e.slice(0,a-1):o&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}},c=!0;try{t[e](o,o.exports,r),c=!1}finally{c&&delete n[e]}return o.exports}r.ab="//";var i=r(114);e.exports=i}()},7663:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(r){n=c}}();var u=[],s=!1,l=-1;function f(){s&&r&&(s=!1,r.length?u=r.concat(u):l=-1,u.length&&h())}function h(){if(!s){var e=a(f);s=!0;for(var t=u.length;t;){for(r=u,u=[];++l<t;)r&&r[l].run();l=-1,t=u.length}r=null,s=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||s||a(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}},c=!0;try{t[e](o,o.exports,r),c=!1}finally{c&&delete n[e]}return o.exports}r.ab="//";var i=r(229);e.exports=i}()},9008:function(e,t,n){e.exports=n(5443)},7568:function(e,t,n){"use strict";function r(e,t,n,r,i,o,c){try{var a=e[o](c),u=a.value}catch(s){n(s);return}a.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){var c=e.apply(t,n);function a(e){r(c,i,o,a,u,"next",e)}function u(e){r(c,i,o,a,u,"throw",e)}a(void 0)})}}n.d(t,{Z:function(){return i}})}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);